{% extends "base.html" %}

{% block content %}

<!-- 游댯 Barra moderna de par치metros + bot칩n Filtros -->
<div class="filters-toolbar d-flex flex-wrap align-items-center justify-content-between mb-3">

    <!-- Par치metros -->
    <div class="d-flex flex-wrap gap-3 align-items-center">

        <!-- Radios de agrupaci칩n -->
        <div class="d-flex flex-wrap gap-3" id="agrouptype_div">
            {% for grouptype in groupingtype %}
                <div class="form-check me-2">
                    <input class="form-check-input" 
                           type="radio" 
                           name="agrouptype" 
                           id="agrouptype_{{ forloop.counter }}" 
                           value="{{ grouptype }}"
                           {% if forloop.first %}checked{% endif %}
                           onchange="locgraficarDatos()">
                    <label class="form-check-label" for="agrouptype_{{ forloop.counter }}">
                        {{ grouptype }}
                    </label>
                </div>
            {% endfor %}
        </div>

        <!-- Select de tipo documento -->
        <select class="form-select" id="typedocument" onchange="locgraficarDatos()">
            {% for code, label in typedocuments %}
                <option value="{{ code }}">{{ label }}</option>
            {% endfor %}
        </select>

    </div>

    <!-- Bot칩n FILTROS -->
    <button class="btn btn-primary d-flex align-items-center gap-2" 
            data-bs-toggle="modal" 
            data-bs-target="#filtersModal">
        <i class="bi bi-funnel"></i> Filtros
    </button>

</div>

<!-- 游댯 Modal -->
{% include "partials/filtros_modal.html" %}

<!-- 游댯 Contenido din치mico -->
<div id="main-filter-content">
    {% block filter_content %}{% endblock %}
</div>

<!-- 游댯 Evento global -->
<script>
    document.addEventListener("filters:apply", function (event) {
        const filters = event.detail;
        console.log("游닍 Filtros aplicados (basefilter recibe):", filters);

        // Reenv칤a evento a invoiced.html
        document.dispatchEvent(new CustomEvent("filters:ready", { detail: filters }));
    });
</script>

{% endblock %}